Option ExplicitSub Auto_Table_Contents()'this procedure adds a table of contents to your active sheet. It creates a hyperlink to each sheet and takes the header from cell A1 of every sheet    Dim Sh As Worksheet    Dim StartCell As Range 'for inputbox    Dim ShName As String    Dim MsgConfirm As VBA.VbMsgBoxResult    Dim EndCell As Range ' for msgbox information        'prompt the user to select a cell    On Error Resume Next    Set StartCell = Excel.Application.InputBox("Where do you want to insert the Table of Contents?" & vbNewLine & "Please select the cell:" _                                , "Insert Table of Contents", , , , , , 8)    If Err.Number = 424 Then Exit Sub    On Error GoTo Handle:                             Set StartCell = StartCell.Cells(1, 1)    Set EndCell = StartCell.Offset(Worksheets.Count - 2, 1)        'allow the user to cancel otherwise their cells might be overwritten    MsgConfirm = MsgBox("The values in cells: " & vbNewLine & _    StartCell.Address & " to " & EndCell.Address & " could be overwritten." _    & vbNewLine & "Would you like to continue?", vbOKCancel + vbDefaultButton2, "Confirmation Required")    If MsgConfirm = vbCancel Then Exit Sub        For Each Sh In Worksheets        ShName = Sh.Name         StartCell = ShName        'include only if sheet is not activesheet and sheet is visible        If ActiveSheet.Name <> ShName Then            If Sh.Visible = xlSheetVisible Then                ActiveSheet.Hyperlinks.Add Anchor:=StartCell, Address:="", SubAddress:= _                 "'" & ShName & "'!A1", TextToDisplay:=ShName                StartCell.Offset(0, 1).Value = Sh.Range("A1").Value                Set StartCell = StartCell.Offset(1, 0)            End If 'if sheet is visible        End If ' if sheet <> activesheet    Next Sh    Exit SubHandle:MsgBox "Unfortunately, an error has occured!"End Sub